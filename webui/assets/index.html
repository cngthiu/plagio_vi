<!doctype html>
<html lang="vi" data-theme="light">
<head>
  <meta charset="utf-8"/>
  <title>plagio_vi ‚Äî WebUI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <link rel="stylesheet" href="/assets/styles.css?v=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<header class="topbar">
  <div class="brand">plagio_vi</div>
  <nav class="nav">
    <button id="btnDark" class="btn ghost" title="Dark / Light">üåô</button>
    <a id="btnOpenHtml" class="btn ghost" href="#">Report HTML</a>
  </nav>
</header>

<main class="container">
  <div class="tabs">
    <button class="tab active" data-tab="compare">So kh·ªõp</button>
    <button class="tab" data-tab="results">K·∫øt qu·∫£</button>
    <button class="tab" data-tab="settings">Settings</button>
  </div>

  <section id="tab-compare" class="tabpane active">
    <div class="card">
      <h2>So kh·ªõp t√†i li·ªáu</h2>
      <form id="compare-form">
        <div class="grid2">
          <div><label>DOCX A</label><input type="file" id="fileA" accept=".docx" required/></div>
          <div><label>DOCX B</label><input type="file" id="fileB" accept=".docx" required/></div>
        </div>
        <div class="grid2">
          <div><label>Output dir</label><input type="text" id="outDir" value="outputs/webui_run"/></div>
          <div><label>Report JSON c√≥ s·∫µn</label><input type="text" id="reportPath" placeholder="outputs/run_A_B/report.json"/></div>
        </div>
        <div class="row">
          <button class="btn primary" type="submit">B·∫Øt ƒë·∫ßu</button>
          <button id="btnLoadReport" class="btn" type="button">M·ªü JSON c√≥ s·∫µn</button>
          <span id="runStatus" class="muted"></span>
        </div>
        <div id="progressWrap" class="progress hidden">
          <div class="progress-bar" id="progressBar" style="width:0%"></div>
          <div class="progress-text"><span id="progressPct">0%</span> ƒêang so kh·ªõp...</div>
        </div>
      </form>
    </div>
  </section>

  <section id="tab-results" class="tabpane">
    <div class="grid2">
      <div class="card">
        <h2>T√†i li·ªáu A (t·ªïng quan)</h2>
        <div class="grid2">
          <div class="donut-card">
            <canvas id="donutScore" width="150" height="150"></canvas>
            <div class="donut-center">
              <div id="pctText" class="pct">0%</div>
              <div id="wordsText" class="muted small">0 t·ª´ tr√πng</div>
            </div>
          </div>
          <div>
            <div class="stat line"><b>Pairs:</b> <span id="statPairs">0</span></div>
            <div class="stat line"><b>Chunks A/B:</b> <span id="statChunksA">0</span>/<span id="statChunksB">0</span></div>
            <div class="stat line"><b>ƒê·ªô ph·ªß (k√Ω t·ª±):</b> <span id="coverText">0 / 0</span></div>
            <div class="stat line"><b>Ngu·ªìn m·∫°nh nh·∫•t:</b> <span id="topSource">‚Äî</span></div>
          </div>
        </div>
        <div class="docbox" id="docAOverview">
          <div class="muted">Ch·ªçn m·ªôt record ·ªü b·∫£ng ‚ÄúK·∫øt qu·∫£ chi ti·∫øt‚Äù ƒë·ªÉ xem highlight c·ª• th·ªÉ.</div>
        </div>
      </div>

      <div class="card">
        <h2>Ngu·ªìn ƒë·ªÅu kh·ªõp v·ªõi</h2>
        <div id="sourcesList" class="sources"></div>
      </div>
    </div>

    <div class="card">
      <h2>C√°c ƒëo·∫°n tr√πng l·∫∑p</h2>
      <div class="filters">
        <select id="filterLevel">
          <option value="">Level: All</option><option value="very_high">very_high</option>
          <option value="high">high</option><option value="medium">medium</option><option value="low">low</option>
        </select>
        <input type="text" id="searchText" placeholder="T√¨m trong text A/B..."/>
        <select id="sortBy">
          <option value="score_desc">Score ‚Üì</option><option value="a_order">Th·ª© t·ª± A</option>
        </select>
        <button id="btnExportCSV" class="btn">Export CSV</button>
      </div>

      <div class="results-list" id="resultsList"></div>
      <div id="emptyResults" class="empty muted small">Ch∆∞a c√≥ k·∫øt qu·∫£ ƒë·ªÉ hi·ªÉn th·ªã ‚Äî h√£y ch·∫°y so kh·ªõp ho·∫∑c n·ªõi l·ªèng b·ªô l·ªçc.</div>

      <div class="pager">
        <button id="prevPage" class="btn">Prev</button>
        <span id="pageInfo" class="muted"></span>
        <button id="nextPage" class="btn">Next</button>
        <select id="pageSize"><option>10</option><option>20</option><option selected>50</option><option>100</option></select>
      </div>
    </div>

    <div class="card">
      <h2>Chi ti·∫øt ƒëo·∫°n ch·ªçn</h2>
      <div class="row" style="justify-content: space-between;">
        <div class="row" style="gap:8px">
          <label><input type="checkbox" id="onlyMatches"> Ch·ªâ hi·ªÉn th·ªã ph·∫ßn tr√πng</label>
        </div>
        <div class="muted small">Cu·ªôn ƒë·ªìng b·ªô b·∫≠t s·∫µn</div>
      </div>
      <div class="grid2">
        <div>
          <h3>A</h3>
          <div id="detailA" class="detail"></div>
          <div id="snipsA" class="snips"></div>
        </div>
        <div>
          <h3>B</h3>
          <div id="detailB" class="detail"></div>
          <div id="snipsB" class="snips"></div>
        </div>
      </div>

      <h3 style="margin-top:14px">C·ª•m tr√πng (A ‚Üî B)</h3>
      <div class="matchgrid">
        <div class="matchcol">
          <div class="matchhead">A</div>
          <div id="matchListA" class="matchlist"></div>
        </div>
        <div class="matchcol">
          <div class="matchhead">B</div>
          <div id="matchListB" class="matchlist"></div>
        </div>
      </div>
    </div>
  </section>

  <section id="tab-settings" class="tabpane">
    <div class="card">
      <h2>C·∫•u h√¨nh YAML (override khi ch·∫°y)</h2>
      <div class="grid2">
        <div>
          <h3>Weights</h3>
          <div class="grid2">
            <label>Cross <input type="number" id="w_cross" step="0.01" min="0" max="1" value="0.55"></label>
            <label>Bi <input type="number" id="w_bi" step="0.01" min="0" max="1" value="0.25"></label>
            <label>Lex <input type="number" id="w_lex" step="0.01" min="0" max="1" value="0.10"></label>
            <label>BM25 <input type="number" id="w_bm25" step="0.01" min="0" max="1" value="0.10"></label>
          </div>
          <h3>Thresholds</h3>
          <div class="grid3">
            <label>very_high ‚â• <input type="number" id="th_vh" step="0.01" min="0" max="1" value="0.82"></label>
            <label>high ‚â• <input type="number" id="th_h" step="0.01" min="0" max="1" value="0.72"></label>
            <label>medium ‚â• <input type="number" id="th_m" step="0.01" min="0" max="1" value="0.60"></label>
          </div>
        </div>
        <div>
          <h3>Penalties</h3>
          <div class="grid2">
            <label>Lex boilerplate Œª <input type="number" id="pen_lambda" step="0.05" min="0" max="1" value="0.5"></label>
            <label>Min span chars <input type="number" id="min_span" min="0" max="200" value="24"></label>
            <label>Small span chars <input type="number" id="small_span" min="0" max="200" value="12"></label>
            <label>Min small spans <input type="number" id="min_small" min="0" max="10" value="2"></label>
          </div>
          <h3>Retrieval</h3>
          <div class="grid2">
            <label>BM25 topK <input type="number" id="bm25_topk" min="1" max="2000" value="30"></label>
            <label>ANN recall topK <input type="number" id="ann_topk" min="1" max="2000" value="50"></label>
            <label>Re-rank topK <input type="number" id="rerank_topk" min="1" max="200" value="8"></label>
            <label>SimHash topK <input type="number" id="simhash_topk" min="1" max="2000" value="40"></label>
          </div>
          <h3>Chunking</h3>
          <div class="grid2">
            <label>Size tokens <input type="number" id="size_tokens" min="50" max="512" value="160"></label>
            <label>Overlap <input type="number" id="overlap" min="0" max="200" value="40"></label>
            <label>Max len bi <input type="number" id="max_seq_bi" min="64" max="512" value="256"></label>
            <label>Max len cross <input type="number" id="max_seq_cross" min="128" max="512" value="384"></label>
          </div>
        </div>
      </div>
      <div class="row">
        <button id="btnLoadSettings" class="btn">Load t·ª´ YAML</button>
        <button id="btnSaveSettings" class="btn primary">Save (browser)</button>
        <span class="muted">Khi ‚ÄúB·∫Øt ƒë·∫ßu‚Äù, settings s·∫Ω override YAML.</span>
      </div>
    </div>
  </section>
</main>

<footer class="foot muted">¬© plagio_vi ‚Äî WebUI</footer>
    <script src="/assets/app.js?v=1"></script>
</body>
</html>
